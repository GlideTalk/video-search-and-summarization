######################################################################################################
# SPDX-FileCopyrightText: Copyright (c) 2024-2025 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
# SPDX-License-Identifier: LicenseRef-NvidiaProprietary
#
# NVIDIA CORPORATION, its affiliates and licensors retain all intellectual
# property and proprietary rights in and to this material, related
# documentation and any modifications thereto. Any use, reproduction,
# disclosure or distribution of this material and related documentation
# without an express license agreement from NVIDIA CORPORATION or
# its affiliates is strictly prohibited.
######################################################################################################
---
summarization:
  enable: true
  method: "batch"
  llm:
    model: "meta/llama-3.1-70b-instruct"
    base_url: "https://integrate.api.nvidia.com/v1"
    max_tokens: 2048
    temperature: 0.2
    top_p: 0.7
  embedding:
    model: "nvidia/llama-3.2-nv-embedqa-1b-v2"
    base_url: "https://integrate.api.nvidia.com/v1"
  params:
    batch_size: 6 # Use even batch size if speech recognition enabled.
  prompts:
    caption: "You should summarize the following events of a Basketball training in the format start_time:end_time:caption. For start_time and end_time use . to seperate seconds, minutes, hours. Note any player activity in detail. The output should be bullet points in the format start_time:end_time: detailed_event_description. Don't return anything else except the bullet points."
    caption_summarization: "I have several grids of images captured from the same basketball video source. Each image corresponds to a video frame with a timestamp (in seconds), and the grids represent sequential time ranges within the video. Based on these provided grids, please determine which specific kind of activity is being performed. Try to be as precise as possible; for example, rather than just 'Dribbling', specify the type such as 'Ball Slaps', 'Crossover', 'Full-court dribbling', 'Chair drills', 'Finger taps' and so on. CRITICAL: For a complete analysis, reference AT LEAST 4-5 specific timestamps in your analysis. Look at the bottom left corner of each frame to see the exact timestamp (shown as X.XXs). Discuss the quality of the performance by evaluating parameters relevant to the activityâ€”for example, the player's technique, movement, posture, leg and hand work, how effectively the ball is handled or shot and/or anything else which might be relevant. IMPORTANT: When referencing specific moments in the video, you have TWO options for timestamp formatting: 1. For individual frames, use: [TS:X.XX] Example: 'At [TS:0.20] the player demonstrates excellent crossover technique.' 2. For a sequence or range of activity, use: [TS:X.XX-Y.YY] Example: 'During [TS:0.00-2.99] we can observe a consistent dribbling pattern.' You MUST include several specific timestamps or timestamp ranges when discussing technique, movement patterns, or notable moments. Please reference the exact timestamps visible in the bottom-left corner of the frames. When noting specific aspects (good or bad), include the corresponding timestamps using the appropriate format. Additionally, if you have any suggestions for improvement, please share them. IMPORTANT VISUAL MARKERS to understand: - WHITE RECTANGLES indicate detected basketball hoops/nets - this is where the player is aiming to shoot - ORANGE CIRCLES mark the detected basketball - ORANGE TRAIL (smaller orange dots) shows the ball's recent trajectory path since the previous frames - The player's body keypoints and posture are shown with colored lines and circles - If enabled, facial landmarks may be visible as dots marking key facial features - If enabled, hand keypoints may be visible showing finger positions and hand poses IMPORTANT NOTES: 1. Focus your analysis on the player's technique, movements, and performance quality 2. Do not mention the presence of any visual markers, overlays, or technical aspects of the video 3. Keep the analysis natural and focused on the basketball activity itself"
    summary_aggregation: "You are an expert sports analyst specializing in Basketball training. Your task is to synthesize a final, comprehensive analysis based on an initial assessment and detailed frame-by-frame validation insights.  **Input Provided:** 1.  **Initial Analysis:** An overview of the activity performed in the video sequence. 2.  **Validation Insights:** Detailed observations from specific frames, potentially correcting or refining the initial analysis. These insights are based on analyzing batches of frames, including those explicitly mentioned in the initial analysis and others identified through pose change detection.  **Your Goal:** Produce a single, coherent, and refined analysis report. Integrate the findings from the validation insights into the initial analysis. Resolve any contradictions, enhance the descriptions, and provide a final, expert assessment of the player's performance, technique, strengths, and areas for improvement.  **Instructions:** 1.  **Synthesize, Don't Just List:** Combine the initial analysis and validation details into a unified narrative. Don't just repeat the inputs. 2.  **Refine and Correct:** Use the validation insights to correct inaccuracies or add nuance to the initial assessment. If validation contradicts the initial analysis, prioritize the validation findings. 3.  **Focus on Key Moments:** Highlight significant moments identified during validation, using their specific timestamps [TS:X.XX] or ranges [TS:X.XX-Y.YY]. 4.  **Maintain Structure:** Organize the final report logically (e.g., Overall Summary, Technique Breakdown, Key Observations, Suggestions for Improvement). 5.  **Timestamp Accuracy:**     *   When referencing specific moments, use the EXACT timestamp format: `[TS:X.XX]` for single frames or `[TS:X.XX-Y.YY]` for ranges.     *   Ensure timestamps correspond to actual events discussed. Use the examples provided in the validation insights.  **Output Format:** Generate the final analysis in Markdown format. Ensure clear headings, bullet points for lists, and **bold text** for emphasis. Make sure all timestamps are correctly formatted as `[TS:X.XX]` or `[TS:X.XX-Y.YY]`.  **Final Reminder:** Only reference timestamps that correspond to actual frames provided in the grid images or the full frame images. Do not invent, estimate, or round timestamps; use the exact timestamps visible or referenced in the provided materials. "

chat:
  rag: graph-rag # graph-rag or vector-rag
  params:
    multi_channel: false
    batch_size: 1
    top_k: 5
  llm:
    model: "meta/llama-3.1-70b-instruct"
    base_url: "https://integrate.api.nvidia.com/v1"
    max_tokens: 2048
    temperature: 0.2
    top_p: 0.7
  embedding:
    model: "nvidia/llama-3.2-nv-embedqa-1b-v2"
    base_url: "https://integrate.api.nvidia.com/v1"
  reranker:
    model: "nvidia/llama-3.2-nv-rerankqa-1b-v2"
    base_url: "https://ai.api.nvidia.com/v1/retrieval/nvidia/llama-3_2-nv-rerankqa-1b-v2/reranking"

notification:
  enable: true
  endpoint: "http://127.0.0.1:60000/via-alert-callback"
  llm:
    model: "meta/llama-3.1-70b-instruct"
    base_url: "https://integrate.api.nvidia.com/v1"
    max_tokens: 2048
    temperature: 0.2
    top_p: 0.7
